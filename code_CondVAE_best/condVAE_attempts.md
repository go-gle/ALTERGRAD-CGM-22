Here we know using a bigger dataset will be useful. To do some architecture exploration though, we will focus on the smaller dataset for speed.
All results will be given without the use of the denoiser.

| h_d_encoder | h_d_decoder | h_d_cond | latent_d | layers_enc | layers_dec | lr   | eval.py     |
| ----------- | ----------- | -------- | -------- | ---------- | ---------- | ---- | ----------- |
| 64          | 256         | 5        | 32       | 2          | 2          | 1e-3 | 0.25533     |
| 64          | 256         | 5        | 32       | 2          | 3          | 1e-3 | 0.26242     |
| 64          | 256         | 5        | 32       | 2          | **4**      | 1e-3 | 0.25119     |
| 64          | 256         | 5        | 32       | 2          | 5          | 1e-3 | 0.25545     |
|             |             |          |          |            |            |      |             |
| 64          | 256         | 5        | 32       | 2          | 4          | 1e-2 | 0.26972     |
| 64          | 256         | 5        | 32       | 2          | 4          | 1e-3 | 0.26878     |
| 64          | 256         | 5        | 32       | 2          | 4          | 1e-4 | 0.40001     |
| 64          | 256         | 5        | 32       | 2          | 4          | 1e-5 | 0.54356     |
|             |             |          |          |            |            |      |             |
| 64          | 256         | 3        | 32       | 2          | 4          | 1e-3 | 0.32768     |
| 64          | 256         | 5        | 32       | 2          | 4          | 1e-3 | 0.26153     |
| 64          | 256         | 8        | 32       | 2          | 4          | 1e-3 | 0.24261     |
| 64          | 256         | 16       | 32       | 2          | 4          | 1e-3 | 0.23787     |
| 64          | 256         | 24       | 32       | 2          | 4          | 1e-3 | 0.23570     |
| 64          | 256         | 32       | 32       | 2          | 4          | 1e-3 | 0.23886     |
| 64          | 256         | **48**   | 32       | 2          | 4          | 1e-3 | **0.22922** |
| 64          | 256         | 64       | 32       | 2          | 4          | 1e-3 | 0.23576     |
| 64          | 256         | 80       | 32       | 2          | 4          | 1e-3 | 0.23806     |
| 64          | 256         | 96       | 32       | 2          | 4          | 1e-3 | 0.23342     |
|             |             |          |          |            |            |      |             |
| 64          | 256         | 48       | 16       | 2          | 4          | 1e-3 | 0.22952     |
| 64          | 256         | 48       | 32       | 2          | 4          | 1e-3 | 0.22419     |
| 64          | 256         | 48       | 48       | 2          | 4          | 1e-3 | 0.22911     |
| 64          | 256         | 48       | **64**   | 2          | 4          | 1e-3 | 0.22268     |
| 64          | 256         | 48       | 80       | 2          | 4          | 1e-3 | 0.22779     |
| 64          | 256         | 48       | 96       | 2          | 4          | 1e-3 | 0.23654     |
| 64          | 256         | 48       | 112      | 2          | 4          | 1e-3 | 0.22937     |
| 64          | 256         | 48       | **128**  | 2          | 4          | 1e-3 | 0.22179     |
| 64          | 256         | 48       | 144      | 2          | 4          | 1e-3 | 0.22894     |
|             |             |          |          |            |            |      |             |

A few remarks regarding that last part : a lot of inconsistencies are being observed (even with all the seeds set). a latent space of 128 led to the "best" score but it consistently gave poor results (>.25). However a latent dimension of 32 to 64 led to good results **consistently**, with 64 having a slight but noticeable edge (around 5 runs were made for each of the interesting values)



| h_d_encoder | h_d_decoder | h_d_cond | latent_d | layers_enc | layers_dec | lr   | eval.py try 1 | eval.py try 2 |
| ----------- | ----------- | -------- | -------- | ---------- | ---------- | ---- | ------------- | ------------- |
| 64          | 256         | 48       | 64       | 1          | 4          | 1e-3 | 0.22829       | 0.23581       |
| 64          | 256         | 48       | 64       | 2          | 4          | 1e-3 | 0.22907       | 0.23636       |
| 64          | 256         | 48       | 64       | 3          | 4          | 1e-3 | 0.22568       | 0.24234       |
| 64          | 256         | 48       | 64       | **4**      | 4          | 1e-3 | 0.22440       | 0.22834       |
| 64          | 256         | 48       | 64       | 5          | 4          | 1e-3 | 0.23147       | 0.23157       |
| 64          | 256         | 48       | 64       | 6          | 4          | 1e-3 | 0.23219       | 0.23135       |
|             |             |          |          |            |            |      |               |               |
|             |             |          |          |            |            |      |               |               |
| 64          | 128         | 48       | 64       | 4          | 4          | 1e-3 | 0.23330       | 0.23530       |
| 64          | 256         | 48       | 64       | 4          | 4          | 1e-3 | 0.22440       | 0.23657       |
| 64          | 512         | 48       | 64       | 4          | 4          | 1e-3 | 0.23094       | 0.22279       |
| 64          | **768**     | 48       | 64       | 4          | 4          | 1e-3 | 0.22398       | 0.22491       |
| 64          | 1024        | 48       | 64       | 4          | 4          | 1e-3 | 0.23497       | 0.22583       |
|             |             |          |          |            |            |      |               |               |
| 32          | 768         | 48       | 64       | 4          | 4          | 1e-3 | **0.21641**   | ~0.226 ?      |
| 64          | 768         | 48       | 64       | 4          | 4          | 1e-3 | 0.22398       | 0.22491       |
| 96          | 768         | 48       | 64       | 4          | 4          | 1e-3 | ~.23          | ~.22          |



I lost the last results with a "~" because of crash and because i didn't save...

---

# bigger dataset

let's train on the bigger training dataset

| h_d_encoder | h_d_decoder | h_d_cond | latent_d | layers_enc | layers_dec | lr   | eval.py try 1 | eval.py try 2 | try 3       | try 4   |
| ----------- | ----------- | -------- | -------- | ---------- | ---------- | ---- | ------------- | ------------- | ----------- | ------- |
| 32          | 768         | 48       | 64       | 4          | 4          | 1e-3 | 0.22685       | 0.22702       | 0.23409     | 0.23313 |
| **64**      | 768         | 48       | 64       | 4          | 4          | 1e-3 | 0.22669       | 0.22833       | **0.22309** | 0.22465 |
|             |             |          |          |            |            |      |               |               |             |         |
| 64          | 768         | 48       | 64       | 6          | 4          | 1e-3 | 0.22795       | 0.22827       |             |         |
| 64          | 768         | 48       | 64       | 4          | 6          | 1e-3 | 0.22433       | 0.22707       |             |         |
| 64          | 768         | 48       | 64       | 6          | 6          | 1e-3 | 0.22716       | 0.22341       |             |         |
|             |             |          |          |            |            |      |               |               |             |         |
|             |             |          |          |            |            |      |               |               |             |         |

