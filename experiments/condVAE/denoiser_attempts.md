We fix a somewhat good CondVAE to try out different denoiser architectures.

Without the denoiser, the eval_script.py score is **0.25688**. We're looking to beat that.

Using the small dataset only :

| hidden dim | dim condition | n layers | n time steps | lr       | eval_script.py score             | kaggle score |
| ---------- | ------------- | -------- | ------------ | -------- | -------------------------------- | ------------ |
| 512        | 0             | 3        | 500          | 1e-3     | 0.25663                          |              |
| 512        | 2             | 3        | 500          | 1e-3     | 0.25781                          |              |
| 512        | 4             | 3        | 500          | 1e-3     | 0.25793                          |              |
| 512        | 8             | 3        | 500          | 1e-3     | 0.25752                          |              |
| 512        | **16**        | 3        | 500          | 1e-3     | **0.25502**                      | .18142       |
| 512        | 32            | 3        | 500          | 1e-3     | 0.25726                          |              |
| 512        | 64            | 3        | 500          | 1e-3     | 0.25926                          |              |
|            |               |          |              |          |                                  |              |
| 512        | 16            | **2**    | 500          | 1e-3     | **0.2548** weird (see below)     |              |
| 512        | 16            | 3        | 500          | 1e-3     | 0.25805                          |              |
| 512        | 16            | 4        | 500          | 1e-3     | 0.25818                          |              |
| 512        | 16            | 5        | 500          | 1e-3     | 0.25699                          |              |
|            |               |          |              |          |                                  |              |
| 512        | 8             | 2        | 500          | 1e-3     | 0.26040 weird (same seed though) |              |
| 512        | 16            | 2        | 500          | 1e-3     | 0.26004                          |              |
| 512        | **32**        | 2        | 500          | 1e-3     | 0.25982                          |              |
|            |               |          |              |          |                                  |              |
| 512        | 16            | 2        | 500          | 1e-3     | 0.26040                          |              |
| 512        | 16            | 2        | 500          | **1e-4** | 0.25817                          |              |
| 512        | 16            | 2        | 500          | 1e-5     | 0.25853                          |              |
|            |               |          |              |          |                                  |              |
| 512        | 16            | 3        | 500          | **1e-3** | 0.25751                          |              |
| 512        | 16            | 3        | 500          | 1e-4     | 0.25778                          |              |
| 512        | 16            | 3        | 500          | 1e-5     | 0.25785                          |              |
|            |               |          |              |          |                                  |              |
| 512        | 16            | 4        | 500          | 1e-3     | 0.25806                          |              |
| 512        | 16            | 4        | 500          | **1e-4** | 0.25753                          |              |
| 512        | 16            | 4        | 500          | 1e-5     | 0.26013                          |              |
|            |               |          |              |          |                                  |              |
| 256        | 16            | 3        | 500          | 1e-4     | 0.25805                          |              |
| 512        | 16            | 3        | 500          | 1e-4     | 0.25777                          |              |
| **1024**   | 16            | 3        | 500          | 1e-4     | 0.25696                          |              |
| 2048       | 16            | 3        | 500          | 1e-4     | 0.26192                          |              |
|            |               |          |              |          |                                  |              |
| 1024       | 16            | 2        | 500          | 1e-4     | 0.25787                          |              |
| 1024       | 16            | 3        | 500          | 1e-4     | 0.25783                          |              |
| 1024       | 16            | 4        | 500          | 1e-4     | 0.25752                          |              |
| 1024       | 16            | 5        | 500          | 1e-4     | 0.25720                          |              |

This is starting to feel pointless.
What's the difference with the big (mostly synthetic) dataset vs the original one (dim_cond = 16, lr = 1e-4, hidden_dim =512, n layers = 3)

small : 0.25778

big : 0.25925

**NO POINT TRAINING THE DENOISER ON THE BIGGER DATASET**

For the parameters themselves, it's probably better doing a grid search once the final autoencoder is found.

---

# Let's play around with the autoencoder that led to the score of .21641

This baseline score was attained with no denoiser. Let's use one now.



| hidden dim | dim condition | n layers | n time steps | lr       | eval_script.py score try 1 | try2    | kaggle score |
| ---------- | ------------- | -------- | ------------ | -------- | -------------------------- | ------- | ------------ |
| 512        | 0             | 3        | 500          | 1e-3     | 0.21852                    | 0.21886 |              |
| 512        | 2             | 3        | 500          | 1e-3     | 0.21859                    | 0.21834 |              |
| 512        | 4             | 3        | 500          | 1e-3     | 0.21853                    | 0.21852 |              |
| 512        | 8             | 3        | 500          | 1e-3     | 0.21984                    | 0.21838 |              |
| 512        | 16            | 3        | 500          | 1e-3     | 0.21864                    | 0.21844 |              |
| 512        | 32            | 3        | 500          | 1e-3     | 0.21885                    | 0.21829 |              |
| 512        | 64            | 3        | 500          | 1e-3     | 0.21832                    | 0.21864 |              |
|            |               |          |              |          |                            |         |              |
| 512        | 32            | 2        | 500          | 1e-3     | 0.21868                    | 0.21860 |              |
| 512        | 32            | **3**    | 500          | 1e-3     | 0.21802                    | 0.21874 |              |
| 512        | 32            | 4        | 500          | 1e-3     | 0.21965                    | 0.21963 |              |
| 512        | 32            | 5        | 500          | 1e-3     | 0.21905                    | 0.21961 |              |
|            |               |          |              |          |                            |         |              |
| 512        | 8             | 2        | 500          | 1e-3     |                            |         |              |
| 512        | 16            | 2        | 500          | 1e-4     |                            |         |              |
| 512        | **32**        | 2        | 500          | 1e-5     |                            |         |              |
|            |               |          |              |          |                            |         |              |
| 512        | 16            | 2        | 500          | 1e-3     |                            |         |              |
| 512        | 16            | 2        | 500          | **1e-4** |                            |         |              |
| 512        | 16            | 2        | 500          | 1e-5     |                            |         |              |
|            |               |          |              |          |                            |         |              |
| 512        | 16            | 3        | 500          | **1e-3** |                            |         |              |
| 512        | 16            | 3        | 500          | 1e-4     |                            |         |              |
| 512        | 16            | 3        | 500          | 1e-5     |                            |         |              |
|            |               |          |              |          |                            |         |              |
| 512        | 16            | 4        | 500          | 1e-3     |                            |         |              |
| 512        | 16            | 4        | 500          | **1e-4** |                            |         |              |
| 512        | 16            | 4        | 500          | 1e-5     |                            |         |              |
|            |               |          |              |          |                            |         |              |
| 256        | 16            | 3        | 500          | 1e-4     |                            |         |              |
| 512        | 16            | 3        | 500          | 1e-4     |                            |         |              |
| **1024**   | 16            | 3        | 500          | 1e-4     |                            |         |              |
| 2048       | 16            | 3        | 500          | 1e-4     |                            |         |              |
|            |               |          |              |          |                            |         |              |
| 1024       | 16            | 2        | 500          | 1e-4     |                            |         |              |
| 1024       | 16            | 3        | 500          | 1e-4     |                            |         |              |
| 1024       | 16            | 4        | 500          | 1e-4     |                            |         |              |
| 1024       | 16            | 5        | 500          | 1e-4     |                            |         |              |
